version: '3.8'  
services:  
  app:  
    build: .  
    ports:  
      - '3000:3000'  
    environment:  
      REDIS_URL: 'redis://redis:6379'  
    depends_on:  
      - redis  
      - redis-stack  

  redis:  
    image: redis:latest  
    volumes:  
      - redis_data:/data  
    ports:  
      - '6379:6379'  

  redis-stack:  
    image: redis/redis-stack:latest  
    ports:  
      - '8001:8001'  
    depends_on:  
      - redis  

volumes:  
  redis_data:  
    driver: local  